<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

    <!-- Komponent pozwalający obiektowi patrzeć na kamerę -->
    <script src="https://unpkg.com/aframe-look-at-component@1.0.0/dist/aframe-look-at-component.min.js"></script>

    <script>
      AFRAME.registerShader('portal', {
        schema: {
          color: { type: 'color', default: '#FFF' },
          timeMsec: { type: 'time', is: 'uniform' }
        },
        vertexShader: `
          varying vec2 vUv;
          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,
        fragmentShader: `
          uniform float timeMsec;
          varying vec2 vUv;
          void main() {
            float time = timeMsec / 1000.0;
            vec2 uv = vUv * 2.0 - 1.0;
            float radius = length(uv);
            float angle = atan(uv.y, uv.x);
            float distort = sin(angle * 5.0 + time * 2.0) * 0.1;
            uv += distort;
            vec3 color = vec3(sin(uv.x * 10.0 + time), cos(uv.y * 10.0 + time), sin(uv.x * uv.y * 10.0 + time));
            gl_FragColor = vec4(color, 1.0);
          }
        `
      });
    </script>
  </head>

  <body>
    <a-scene embedded arjs="patternRatio: 0.80">
      <!-- Dodanie fonta Cy Grotesk Key -->
      <a-assets>
        <a-asset-item id="cyGroteskFont" src="https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"></a-asset-item>
      </a-assets>

      <a-marker type="pattern" url="https://raw.githubusercontent.com/solrime/lokalni/refs/heads/main/pattern-adobe-express-qr-code%20(13).patt">

        <!-- Główna rzeźba (oko) - patrzy na kamerę -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/1c28bb33aa854dbb90afaf97e051c750.glb)"
          position="0 0 0"
          scale="1 1 1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
      
        ></a-entity>

        <!-- Mniejsze oczy rozmieszczone równomiernie wokół głównego oka -->
        <!-- Oczy z parzystymi indeksami patrzą w kamerę, nieparzyste się obracają -->
        
        <!-- 1. Oko (0°) - patrzy w kamerę + ruch w osi Z -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/35282dbf5d3f49878a1f49979bc1b64c.glb)"
          position="0.7 0 0"
          scale="0.1 0.1 0.1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation="property: position; to: 0.7 0 0.3; loop: true; dur: 3000; dir: alternate; easing: easeInOutSine"
        ></a-entity>

        <!-- 2. Oko (45°) - obraca się + ruch w osi Z -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/35282dbf5d3f49878a1f49979bc1b64c.glb)"
          position="0.5 0.5 0"
          scale="0.1 0.1 0.1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
          animation="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear"
          animation__2="property: position; to: 0.5 0.5 -0.4; loop: true; dur: 3500; dir: alternate; easing: easeInOutSine"
        ></a-entity>

        <!-- 3. Oko (90°) - patrzy w kamerę + ruch w osi Z -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/35282dbf5d3f49878a1f49979bc1b64c.glb)"
          position="0 0.7 0"
          scale="0.1 0.1 0.1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation="property: position; to: 0 0.7 0.5; loop: true; dur: 4000; dir: alternate; easing: easeInOutSine"
        ></a-entity>

        <!-- 4. Oko (135°) - obraca się + ruch w osi Z -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/35282dbf5d3f49878a1f49979bc1b64c.glb)"
          position="-0.5 0.5 0"
          scale="0.1 0.1 0.1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
          animation="property: rotation; to: 360 0 360; loop: true; dur: 6000; easing: linear"
          animation__2="property: position; to: -0.5 0.5 -0.2; loop: true; dur: 2500; dir: alternate; easing: easeInOutSine"
        ></a-entity>

        <!-- 5. Oko (180°) - patrzy w kamerę + ruch w osi Z -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/35282dbf5d3f49878a1f49979bc1b64c.glb)"
          position="-0.7 0 0"
          scale="0.1 0.1 0.1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation="property: position; to: -0.7 0 0.4; loop: true; dur: 3200; dir: alternate; easing: easeInOutSine"
        ></a-entity>

        <!-- 6. Oko (225°) - obraca się + ruch w osi Z -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/35282dbf5d3f49878a1f49979bc1b64c.glb)"
          position="-0.5 -0.5 0"
          scale="0.1 0.1 0.1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
          animation="property: rotation; to: 0 360 360; loop: true; dur: 7000; easing: linear"
          animation__2="property: position; to: -0.5 -0.5 -0.3; loop: true; dur: 3800; dir: alternate; easing: easeInOutSine"
        ></a-entity>

        <!-- 7. Oko (270°) - patrzy w kamerę + ruch w osi Z -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/35282dbf5d3f49878a1f49979bc1b64c.glb)"
          position="0 -0.7 0"
          scale="0.1 0.1 0.1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation="property: position; to: 0 -0.7 0.6; loop: true; dur: 4500; dir: alternate; easing: easeInOutSine"
        ></a-entity>

        <!-- 8. Oko (315°) - obraca się + ruch w osi Z -->
        <a-entity
          gltf-model="url(https://cdn.tinyglb.com/models/35282dbf5d3f49878a1f49979bc1b64c.glb)"
          position="0.5 -0.5 0"
          scale="0.1 0.1 0.1"
          rotation="0 0 0"
          material="opacity: 0; transparent: true"
          animation="property: rotation; to: 360 360 0; loop: true; dur: 8000; easing: linear"
          animation__2="property: position; to: 0.5 -0.5 -0.5; loop: true; dur: 2800; dir: alternate; easing: easeInOutSine"
        ></a-entity>

        <!-- 13 napisów "do not fear us" z fontem Cy Grotesk Key -->
        <a-entity
          id="text-message-1"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-2"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-3"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-4"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-5"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-6"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-7"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-8"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-9"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-10"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-11"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-12"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

        <a-entity
          id="text-message-13"
          text="value: do not fear us; align: center; color: white; width: 1.3; font: https://cdn.jsdelivr.net/npm/@cylab/grotesk@1.0.0/fonts/CyGroteskKey-Regular.woff"
          position="0 0 0"
          material="opacity: 0; transparent: true"
          look-at="[camera]"
          animation__appear="property: material.opacity; to: 1; dur: 500; startEvents: showText; autoplay: false"
          animation__disappear="property: material.opacity; to: 0; dur: 500; startEvents: hideText; autoplay: false"
          visible="false"
        ></a-entity>

      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <script>
      // Tablica z wszystkimi napisami
      let textElements = [];

      // Funkcja do generowania losowej pozycji
      function getRandomPosition() {
        const randomX = (Math.random() - 0.5) * 2.5; // -1.25 do 1.25
        const randomY = Math.random() * 1.5 + 0.3; // 0.3 do 1.8
        const randomZ = (Math.random() - 0.5) * 2.5; // -1.25 do 1.25
        return `${randomX} ${randomY} ${randomZ}`;
      }

      // Funkcja do losowego pojawiania się i znikania napisów
      function manageTexts() {
        textElements.forEach(textElement => {
          // Losowo decyduj czy pokazać czy ukryć napis
          if (Math.random() > 0.5) {
            // Pokaż napis
            if (!textElement.isVisible) {
              const newPosition = getRandomPosition();
              textElement.setAttribute('position', newPosition);
              textElement.setAttribute('visible', 'true');
              textElement.emit('showText');
              textElement.isVisible = true;
              
              // Ukryj po losowym czasie (1-3 sekundy)
              setTimeout(() => {
                if (textElement.isVisible) {
                  textElement.emit('hideText');
                  setTimeout(() => {
                    textElement.setAttribute('visible', 'false');
                    textElement.isVisible = false;
                  }, 500);
                }
              }, Math.random() * 2000 + 1000);
            }
          }
        });

        // Kontynuuj co 500ms
        setTimeout(manageTexts, 500);
      }

      // Zacznij cykl po załadowaniu sceny
      document.querySelector('a-scene').addEventListener('loaded', function() {
        // Zbierz wszystkie elementy tekstowe
        for (let i = 1; i <= 13; i++) {
          const textElement = document.getElementById(`text-message-${i}`);
          textElement.isVisible = false;
          textElements.push(textElement);
        }
        
        // Zacznij zarządzanie napisami po 1 sekundzie
        setTimeout(manageTexts, 1000);
      });
    </script>
  </body>
</html>