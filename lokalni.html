<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
      AFRAME.registerShader('portal', {
        schema: {
          color: { type: 'color', default: '#FFF' },
          timeMsec: { type: 'time', is: 'uniform' }
        },
        vertexShader: `
          varying vec2 vUv;
          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,
        fragmentShader: `
          uniform float timeMsec;
          varying vec2 vUv;
          void main() {
            float time = timeMsec / 1000.0;
            vec2 uv = vUv * 2.0 - 1.0;
            float radius = length(uv);
            float angle = atan(uv.y, uv.x);
            float distort = sin(angle * 5.0 + time * 2.0) * 0.1;
            uv += distort;
            vec3 color = vec3(sin(uv.x * 10.0 + time), cos(uv.y * 10.0 + time), sin(uv.x * uv.y * 10.0 + time));
            gl_FragColor = vec4(color, 1.0);
          }
        `
      });
    </script>
  </head>
  <body>
    <a-scene embedded arjs="patternRatio: 0.80">
      <a-marker type="pattern" url="https://cdn.glitch.global/5bf4d669-ea93-4da0-b7fa-205ee046ca5a/pattern-adobe-express-qr-code%20(3).patt?v=1740596993003">
        
        <!-- Przezroczysty Prostopadłościan -->
        <a-box position="0 0 0" rotation="0 0 0" color="#4CC3D9" scale="1 1 1" opacity="0.5"></a-box>

        <!-- Kula wewnątrz prostopadłościanu -->
        <a-sphere id="colorSphere" position="0 0 0" radius="0.25" color="#FFFFFF"></a-sphere>

        <!-- Portal z shaderem -->
        <a-plane position="0 0.51 0" rotation="-90 0 0" width="1" height="1"
          material="shader: portal; side: double">
        </a-plane>

        <!-- Powiększony kubik w środku portalu -->
        <a-box position="0 0.51 0" scale="0.5 0.5 0.5" color="#FF0000"></a-box>

      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
  </body>
</html>